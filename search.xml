<?xml version="1.0" encoding="utf-8"?>
<search> 
  
  
    
    <entry>
      <title>çº¿æ€§æ¨¡å‹å…¬å¼æ¨å¯¼ï¼ˆäºŒï¼‰</title>
      <link href="/2019/11/25/xian-xing-mo-xing-gong-shi-tui-dao-er/"/>
      <url>/2019/11/25/xian-xing-mo-xing-gong-shi-tui-dao-er/</url>
      
        <content type="html"><![CDATA[<h1 id="çº¿æ€§æ¨¡å‹å…¬å¼æ¨å¯¼ï¼ˆäºŒï¼‰"><a href="#çº¿æ€§æ¨¡å‹å…¬å¼æ¨å¯¼ï¼ˆäºŒï¼‰" class="headerlink" title="çº¿æ€§æ¨¡å‹å…¬å¼æ¨å¯¼ï¼ˆäºŒï¼‰"></a>çº¿æ€§æ¨¡å‹å…¬å¼æ¨å¯¼ï¼ˆäºŒï¼‰</h1><h2 id="é€»è¾‘å›å½’å…¬å¼æ¨å¯¼"><a href="#é€»è¾‘å›å½’å…¬å¼æ¨å¯¼" class="headerlink" title="é€»è¾‘å›å½’å…¬å¼æ¨å¯¼"></a>é€»è¾‘å›å½’å…¬å¼æ¨å¯¼</h2><h3 id="é€»è¾‘å›å½’æ¨å¯¼æ€è·¯"><a href="#é€»è¾‘å›å½’æ¨å¯¼æ€è·¯" class="headerlink" title="é€»è¾‘å›å½’æ¨å¯¼æ€è·¯"></a>é€»è¾‘å›å½’æ¨å¯¼æ€è·¯</h3><ol><li><p>é€»è¾‘å›å½’æ˜¯å¦‚ä½•è¢«å»ºæ¨¡å‡ºæ¥çš„</p></li><li><p>é€»è¾‘å›å½’çš„æŸå¤±å‡½æ•°æ˜¯ä»€ä¹ˆä»¥åŠæ˜¯å¦‚ä½•å¾—å‡ºçš„</p></li><li><p>é€»è¾‘å›å½’çš„å‚æ•°å¦‚ä½•å¾—å‡º</p></li></ol><p>é€»è¾‘å›å½’åˆå«å¯¹æ•°å‡ ç‡å›å½’ï¼Œé‚£ä¹ˆå®ƒæ˜¯æ€ä¹ˆå¾—å‡ºæ¥çš„å‘¢ï¼Ÿè¿™é‡Œä»‹ç»ä¸¤ç§å»ºæ¨¡æ–¹æ³•ï¼š</p><h3 id="å»ºæ¨¡æ–¹æ³•ä¸€"><a href="#å»ºæ¨¡æ–¹æ³•ä¸€" class="headerlink" title="å»ºæ¨¡æ–¹æ³•ä¸€"></a>å»ºæ¨¡æ–¹æ³•ä¸€</h3><h4 id="å¹¿ä¹‰çº¿æ€§æ¨¡å‹"><a href="#å¹¿ä¹‰çº¿æ€§æ¨¡å‹" class="headerlink" title="å¹¿ä¹‰çº¿æ€§æ¨¡å‹"></a>å¹¿ä¹‰çº¿æ€§æ¨¡å‹</h4><p>ä¸Šä¸€ç¯‡ä¸­çš„åŸºç¡€çº¿æ€§æ¨¡å‹æˆ‘ä»¬ç”¨$w^Tx+b$ç›´æ¥å»æ‹Ÿåˆç»“æœyã€‚å³ï¼š$y=w^Tx+b$</p><p>ç°åœ¨æˆ‘ä»¬ç”¨çº¿æ€§æ¨¡å‹å»æ‹Ÿåˆç»“æœyçš„å‡½æ•°g(y)ï¼ˆä¸€èˆ¬è€ƒè™‘å•è°ƒå¯å¾®å‡½æ•°ï¼‰å³ï¼š$g(y)=w^Tx+b$ï¼Œè¿™å°±æ˜¯å¹¿ä¹‰çº¿æ€§æ¨¡å‹ã€‚</p><p>å‡½æ•°g()è¢«ç§°ä¸ºè”ç³»å‡½æ•°ã€‚</p><h4 id="é€»è¾‘å›å½’å…¬å¼çš„å¯¼å‡º"><a href="#é€»è¾‘å›å½’å…¬å¼çš„å¯¼å‡º" class="headerlink" title="é€»è¾‘å›å½’å…¬å¼çš„å¯¼å‡º"></a>é€»è¾‘å›å½’å…¬å¼çš„å¯¼å‡º</h4><p>é€»è¾‘å›å½’æ˜¯åœ¨å¯¹ä¸€ä¸ªäºŒåˆ†ç±»é—®é¢˜å»ºæ¨¡ï¼Œæ‰€ä»¥å®ƒçš„æ ·æœ¬æœ‰æ­£ä¸è´Ÿä¸¤ä¸ªåˆ†ç±»ã€‚é¦–å…ˆæˆ‘ä»¬å‡è®¾yä¸ºæ ·æœ¬xä¸ºæ­£ä¾‹çš„æ¦‚ç‡ã€‚åˆ™(1-y)ä¸ºxä¸ºåä¾‹çš„æ¦‚ç‡ï¼Œä»–ä»¬ä¸¤è€…çš„æ¯”å€¼ä¸º$\frac{y}{1-y}$,æˆ‘ä»¬å¯¹å®ƒå–å¯¹æ•°åˆ™å¯å¾—$ln\frac{y}{1-y}$,ç„¶åæˆ‘ä»¬ç”¨çº¿æ€§æ¨¡å‹å»æ‹Ÿåˆå®ƒåˆ™æœ‰:</p><script type="math/tex; mode=display">ln\frac{y}{1-y}=w^Tx+b</script><p>ä¸‹é¢æˆ‘ä»¬æ¥æ¨ä¸€ä¸‹,ç”±ä¸Šå¼å¯å¾—</p><script type="math/tex; mode=display">\frac{y}{1-y}=e^{w^Tx+b}</script><script type="math/tex; mode=display">y=e^{w^Tx+b}-e^{w^Tx+b}y</script><script type="math/tex; mode=display">(1+e^{w^Tx+b})y=e^{w^Tx+b}</script><script type="math/tex; mode=display">y=\frac{e^{w^Tx+b} } {(1+e^{w^Tx+b})}</script><script type="math/tex; mode=display">y=\frac{1} { {e^{w^Tx+b} }^{-1}+1}</script><script type="math/tex; mode=display">y=\frac{1} { {1+e^{-(w^Tx+b)} }  }</script><h3 id="å»ºæ¨¡æ–¹æ³•äºŒ"><a href="#å»ºæ¨¡æ–¹æ³•äºŒ" class="headerlink" title="å»ºæ¨¡æ–¹æ³•äºŒ"></a>å»ºæ¨¡æ–¹æ³•äºŒ</h3><h4 id="æŒ‡æ•°æ—åˆ†å¸ƒ"><a href="#æŒ‡æ•°æ—åˆ†å¸ƒ" class="headerlink" title="æŒ‡æ•°æ—åˆ†å¸ƒ"></a>æŒ‡æ•°æ—åˆ†å¸ƒ</h4><p>åˆ†å¸ƒå¾‹æ»¡è¶³ä¸‹å¼å³ä¸ºæŒ‡æ•°æ—åˆ†å¸ƒï¼š</p><script type="math/tex; mode=display">p(y;\eta) = b(y) exp(\eta ^TT(y)-a(\eta))</script><p>é€»è¾‘å›å½’æ˜¯åœ¨å¯¹ä¸€ä¸ªäºŒåˆ†ç±»é—®é¢˜å»ºæ¨¡ï¼Œåˆ™æˆ‘ä»¬å¯ä»¥å¾ˆåˆç†çš„å‡è®¾è¯¥äºŒåˆ†ç±»ç¬¦åˆä¼¯åŠªåˆ©åˆ†å¸ƒ</p><p>å‡è®¾yå–å€¼ä¸º1æ—¶çš„æ¦‚ç‡ä¸º$\phi$</p><p>ä¼¯åŠªåŠ›åˆ†å¸ƒåˆ†å¸ƒå¾‹ä¸ºï¼š</p><script type="math/tex; mode=display">\begin{aligned} p(y)&=\phi ^y(1-\phi)^{1-y} \\&=exp(ln(\phi^y(1-\phi)^{1-y}))\\&=exp(y ln\phi + (1-y)ln(1-\phi))\\&=exp(y(ln\phi-ln(1-\phi))+ln(1-\phi))\\&=exp\left(yln\left(\frac{\phi}{1-\phi}\right) +ln(1-\phi)\right)\end{aligned}</script><p>å¯¹ç…§æŒ‡æ•°æ—åˆ†å¸ƒçš„åˆ†å¸ƒå¾‹å¯å¾—ï¼š    $b(y)=1 \qquad \eta = ln\left(\frac{\phi}{1-\phi}\right) \qquad T(y) = y \qquad a(\eta) = -ln(1-\phi) = ln(1+e^{\eta})$</p><p>æ‰€ä»¥ä¼¯åŠªåŠ›åˆ†å¸ƒä¸ºæŒ‡æ•°æ—åˆ†å¸ƒã€‚</p><p>æˆ‘ä»¬çœ‹ä¸€ä¸‹ç”±ï¼š<script type="math/tex">\eta = ln\left(\frac{\phi}{1-\phi}\right)</script></p><p>å¯å¾—ï¼š<script type="math/tex">e^{\eta}=\frac{\phi}{1-\phi}</script></p><script type="math/tex; mode=display">e^{-\eta}=\frac{1}{\phi}-1</script><script type="math/tex; mode=display">\phi = \frac{1}{1+e^{-\eta}} \qquad(1.0)</script><p>å¥½ï¼Œæˆ‘ä»¬å…ˆæ¨åˆ°è¿™é‡Œä¸‹é¢æˆ‘ä»¬çœ‹ä¸€ä¸‹å¹¿ä¹‰çº¿æ€§æ¨¡å‹çš„ä¸‰ä¸ªæ€§è´¨ã€‚</p><h4 id="æ ¹æ®å¹¿ä¹‰çº¿æ€§æ¨¡å‹ä¸‰å¤§å‡è®¾å»ºç«‹é€»è¾‘å›å½’æ¨¡å‹è¡¨è¾¾å¼"><a href="#æ ¹æ®å¹¿ä¹‰çº¿æ€§æ¨¡å‹ä¸‰å¤§å‡è®¾å»ºç«‹é€»è¾‘å›å½’æ¨¡å‹è¡¨è¾¾å¼" class="headerlink" title="æ ¹æ®å¹¿ä¹‰çº¿æ€§æ¨¡å‹ä¸‰å¤§å‡è®¾å»ºç«‹é€»è¾‘å›å½’æ¨¡å‹è¡¨è¾¾å¼"></a>æ ¹æ®å¹¿ä¹‰çº¿æ€§æ¨¡å‹ä¸‰å¤§å‡è®¾å»ºç«‹é€»è¾‘å›å½’æ¨¡å‹è¡¨è¾¾å¼</h4><p>é€šè¿‡ä¸‹é¢ä¸‰æ¡å‡è®¾æ„å»ºå‡ºæ¥çš„æ¨¡å‹å°±æ˜¯å¹¿ä¹‰çº¿æ€§æ¨¡å‹ï¼š</p><ol><li>åœ¨ç»™å®šxçš„æ¡ä»¶ä¸‹ï¼Œå‡è®¾yæœä»æŸä¸ªæŒ‡æ•°æ—åˆ†å¸ƒã€‚</li><li>åœ¨ç»™å®šxçš„æ¡ä»¶ä¸‹ï¼Œæˆ‘ä»¬çš„ç›®æ ‡æ˜¯å¾—åˆ°ä¸€ä¸ªæ¨¡å‹h(x)èƒ½é¢„æµ‹å‡ºT(y)çš„æœŸæœ›å€¼ã€‚</li><li>å‡è®¾è¯¥æŒ‡æ•°æ—åˆ†å¸ƒä¸­çš„å‚æ•°$\etaä¸xå‘ˆçº¿æ€§å…³ç³»ï¼š\eta = w^Tx$</li></ol><p>ä¸‹é¢æˆ‘ä»¬å°±æ ¹æ®è¿™ä¸‰æ¡å‡è®¾æ¥å»ºæ¨¡ï¼š</p><p>æˆ‘ä»¬å‰é¢åœ¨ä»‹ç»æŒ‡æ•°åˆ†å¸ƒæ—çš„æ—¶å€™å·²ç»è¯æ˜äº†ä¼¯åŠªåˆ©åˆ†å¸ƒæ˜¯å±äºæŒ‡æ•°åˆ†å¸ƒæ—çš„äº†ï¼Œè€Œé€»è¾‘å›å½’ä¹Ÿæ˜¯å»ºç«‹åœ¨ä¼¯åŠªåˆ©åˆ†å¸ƒçš„åŸºç¡€ä¸Šæ‰€ä»¥ç¬¬ä¸€æ¡å‡è®¾çš„å·²ç»æ»¡è¶³ã€‚<br>ä¸‹é¢çœ‹ç¬¬äºŒæ¡å‡è®¾ï¼Œç”±ä¸Šæ–‡ä¸­T(y)]=y å¯å¾—ï¼š</p><script type="math/tex; mode=display">h(x)=E[T(y)]=E(y)</script><script type="math/tex; mode=display">E[y]=1\cdot p(y=1)+0\cdot p(y=0)=p(y=1)=\phi</script><script type="math/tex; mode=display">h(x)=\phi</script><p>ç”±ä¸Šé¢çš„å¼ï¼ˆ1.0å¯å¾—ï¼‰</p><script type="math/tex; mode=display">h(x)= \frac{1}{1+e^{-\eta}}</script><p>å†æ ¹æ®ç¬¬ä¸‰æ¡å‡è®¾å¯å¾—ï¼š</p><script type="math/tex; mode=display">h(x)= \frac{1}{1 +e^ {-w^Tx}}</script><p>è¿™æ ·æˆ‘ä»¬ä¾¿å¾—å‡ºäº†é€»è¾‘å›å½’çš„æ¨¡å‹è¡¨è¾¾å¼äº†</p><h3 id="é€»è¾‘å›å½’çš„æŸå¤±å‡½æ•°æ„å»º"><a href="#é€»è¾‘å›å½’çš„æŸå¤±å‡½æ•°æ„å»º" class="headerlink" title="é€»è¾‘å›å½’çš„æŸå¤±å‡½æ•°æ„å»º"></a>é€»è¾‘å›å½’çš„æŸå¤±å‡½æ•°æ„å»º</h3><p>å› ä¸ºæˆ‘ä»¬å‡è®¾æˆ‘ä»¬ç ”ç©¶çš„äºŒåˆ†ç±»é—®é¢˜ç¬¦åˆä¼¯åŠªåˆ©åˆ†å¸ƒï¼Œyçš„å–å€¼ä¸º0(è´Ÿä¾‹)æˆ–1(æ­£ä¾‹)ã€‚ç”±å‰æ–‡çŸ¥â„(ğ‘¥)ä¸ºæ ·æœ¬æ˜¯æ­£ä¾‹çš„æ¦‚ç‡ï¼Œåˆ™ï¼š</p><script type="math/tex; mode=display">p(y_i|x_i)=\begin{cases}h(x_i)& {y_i=1}\\1-h(x_i)& {y_i=0}\end{cases}</script><p>æŠŠä¸Šé¢ä¸¤ä¸ªå¼å­å†™åœ¨ä¸€èµ·ä¸ºï¼š</p><script type="math/tex; mode=display">p(y_i|x_i)=h(x_i)^{y_i}(1-h(x_i)^{(1-y_i)}</script><p>å‡è®¾ç°åœ¨æœ‰mä¸ªæ ·æœ¬ï¼Œåˆ™å®ƒä»¬çš„è”åˆæ¦‚ç‡ï¼ˆå³ä¼¼ç„¶å‡½æ•°ï¼‰ä¸ºï¼š</p><script type="math/tex; mode=display">L=\prod\limits_{i=1}^mp(y_i|x_i)</script><p>å–å¯¹æ•°ä¸ºï¼š</p><script type="math/tex; mode=display">lnL(w)=\sum\limits_{i=1}^mlnï¼ˆh(x_i)^{y_i}(1-h(x_i)^{(1-y_i)}ï¼‰=\sum\limits_{i=1}^m({y_i}lnh(x_i)+{(1-y_i)}ln(1-h(x_i)))</script><h3 id="ç”¨æå¤§ä¼¼ç„¶ä¼°è®¡æ³•å¾—å‡ºé€»è¾‘å›å½’çš„æœ€ä¼˜å‚æ•°"><a href="#ç”¨æå¤§ä¼¼ç„¶ä¼°è®¡æ³•å¾—å‡ºé€»è¾‘å›å½’çš„æœ€ä¼˜å‚æ•°" class="headerlink" title="ç”¨æå¤§ä¼¼ç„¶ä¼°è®¡æ³•å¾—å‡ºé€»è¾‘å›å½’çš„æœ€ä¼˜å‚æ•°"></a>ç”¨æå¤§ä¼¼ç„¶ä¼°è®¡æ³•å¾—å‡ºé€»è¾‘å›å½’çš„æœ€ä¼˜å‚æ•°</h3><p>$y_1,y_2,\cdots,y_mæ˜¯ç‹¬ç«‹åŒåˆ†å¸ƒçš„ï¼Œæ‰€ä»¥ä»–ä»¬çš„è”åˆæ¦‚ç‡å¯†åº¦å‡½æ•°ä¸ºL(w)=\prod\limits_{i=1}^mp(y_i|x_i;w,b)\qquadæ­¤ä¸ºä¼¼ç„¶å‡½æ•°$</p><p>lnL(w)ä¸L(w)æœ‰ç›¸åŒæœ€å¤§å€¼ç‚¹ $lnL(w)=\sum\limits_{i=1}^mlnp(y_i|x_i;w,b)$</p><p>$p(y=1|x) = \frac{e^{w^Tx+b}}{1+e^{w^Tx+b}}\qquad$<br>$p(y=0|x) = \frac1{1+e^{w^Tx+b}}$</p><p>ä»¤$w^Tx+b = \hat w \hat x$</p><p>$p(y=1|x) = \frac{e^{\hat w \hat x}}{1+e^{\hat w \hat x}}=p_1(\hat x;\hat w)\qquad$<br>$p(y=0|x) = \frac1{1+e^{\hat w \hat x}}=p_0(\hat x;\hat w)$</p><p>æŠŠä¸Šé¢çš„ä¸¤ä¸ªå¼å­å†™åœ¨ä¸€èµ·ä¸ºï¼š</p><script type="math/tex; mode=display">p(y|x;w,b)=[p_1(\hat x;\hat w)]^y[ p_0(\hat x;\hat w)]^{1-y}\qquad\qquad(1.10)</script><p>å¯¹æ•°ä¼¼ç„¶å‡½æ•°ä¸ºï¼š</p><script type="math/tex; mode=display">\begin{aligned} lnL(w,b)&=\sum\limits_{i=1}^mlnp(y_i|x_i;w,b)\\&=\sum\limits_{i=1}^mln[p_1(\hat x_i;\hat w)]^y[ p_0(\hat x_i;\hat w)]^{1-y}\\&=\sum\limits_{i=1}^m[y_iln(p_1(\hat x_i;\hat w))+(1-y_i)ln(p_0(\hat x_i;\hat w))]\\&=\sum\limits_{i=1}^m[y_iln\left(\frac{p_1(\hat x_i;\hat w)}{p_0(\hat x_i;\hat w)}\right)+ln(p_0(\hat x_i;\hat w))]\end{aligned}</script><p>ä»£å…¥ï¼š$p(y=1|x) = \frac{e^{\hat w \hat x}}{1+e^{\hat w \hat x}}=p_1(\hat x;\hat w)\qquad$<br>$p(y=0|x) = \frac1{1+e^{\hat w \hat x}}=p_0(\hat x;\hat w)$</p><script type="math/tex; mode=display">\begin{aligned} lnL(w,b)&=\sum\limits_{i=1}^m\left[y_iln(e^{\hat w^T\hat x_i})+ln\left(\frac{1}{1+e^{\hat w^T\hat x_i}}\right)\right]\\&=\sum\limits_{i=1}^m\left(y_i\hat w^T\hat x_i-ln(1+e^{\hat w^T\hat x_i})\right)\end{aligned}</script><h2 id="æ„ŸçŸ¥å™¨æ¨¡å‹å…¬å¼æ¨å¯¼"><a href="#æ„ŸçŸ¥å™¨æ¨¡å‹å…¬å¼æ¨å¯¼" class="headerlink" title="æ„ŸçŸ¥å™¨æ¨¡å‹å…¬å¼æ¨å¯¼"></a>æ„ŸçŸ¥å™¨æ¨¡å‹å…¬å¼æ¨å¯¼</h2>]]></content>
      
      
      <categories>
          
          <category> æœºå™¨å­¦ä¹ æ¨¡å‹ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> é™é­” </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>çº¿æ€§æ¨¡å‹ä»£ç å®ç°</title>
      <link href="/2019/11/25/xian-xing-mo-xing-dai-ma-shi-xian/"/>
      <url>/2019/11/25/xian-xing-mo-xing-dai-ma-shi-xian/</url>
      
        <content type="html"><![CDATA[<h1 id="çº¿æ€§æ¨¡å‹å®ç°"><a href="#çº¿æ€§æ¨¡å‹å®ç°" class="headerlink" title="çº¿æ€§æ¨¡å‹å®ç°"></a>çº¿æ€§æ¨¡å‹å®ç°</h1><h2 id="åˆ›å»ºä¸€ä¸ªé€šç”¨çš„Estimator"><a href="#åˆ›å»ºä¸€ä¸ªé€šç”¨çš„Estimator" class="headerlink" title="åˆ›å»ºä¸€ä¸ªé€šç”¨çš„Estimator"></a>åˆ›å»ºä¸€ä¸ªé€šç”¨çš„Estimator</h2><pre class="line-numbers language-lang-python"><code class="language-lang-python">import warningswarnings.filterwarnings('ignore')import loggingimport autograd.numpy as npfrom autograd import gradnp.random.seed(1000)<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><pre class="line-numbers language-lang-python"><code class="language-lang-python">class BaseEstimator(object):    X = None    y = None    y_required = True    fit_required = True    def _setup_input(self, X, y=None):        """        å‚æ•°        ----------        X : å®ä¾‹        y : é¢„æµ‹ç»“æœ        """        if not isinstance(X, np.ndarray):            X = np.array(X)        if X.size == 0:            raise ValueError("Number of features must be > 0")        if X.ndim == 1:            self.n_samples, self.n_features = 1, X.shape        else:            self.n_samples, self.n_features = X.shape[0], np.prod(X.shape[1:])        self.X = Xå‚æ•°        if self.y_required:            if y is None:                raise ValueError("Missed required argument y")            if not isinstance(y, np.ndarray):                y = np.array(y)            if y.size == 0:                raise ValueError("Number of targets must be > 0")        self.y = y    def fit(self, X, y=None):        self._setup_input(X, y)    def predict(self, X=None):        if not isinstance(X, np.ndarray):            X = np.array(X)        if self.X is not None or not self.fit_required:            return self._predict(X)        else:            raise ValueError("You must call `fit` before `predict`")    def _predict(self, X=None):        raise NotImplementedError()<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><pre class="line-numbers language-lang-python"><code class="language-lang-python">EPS = 1e-15<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h2 id="å®šä¹‰ä¸€äº›è¯„ä»·æŒ‡æ ‡"><a href="#å®šä¹‰ä¸€äº›è¯„ä»·æŒ‡æ ‡" class="headerlink" title="å®šä¹‰ä¸€äº›è¯„ä»·æŒ‡æ ‡"></a>å®šä¹‰ä¸€äº›è¯„ä»·æŒ‡æ ‡</h2><pre class="line-numbers language-lang-python"><code class="language-lang-python">def accuracy(actual, predicted):    return 1.0 - classification_error(actual, predicted)def mean_squared_error(actual, predicted):    return np.mean(squared_error(actual, predicted))def binary_crossentropy(actual, predicted):    predicted = np.clip(predicted, EPS, 1 - EPS)    return np.mean(-np.sum(actual * np.log(predicted) + (1 - actual) * np.log(1 - predicted)))def squared_error(actual, predicted):    return (actual - predicted) ** 2def classification_error(actual, predicted):    return (actual != predicted).sum() / float(actual.shape[0])<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="åŸºäºæ¢¯åº¦ä¸‹é™æ³•çš„åŸºæœ¬å›å½’æ¨¡å‹"><a href="#åŸºäºæ¢¯åº¦ä¸‹é™æ³•çš„åŸºæœ¬å›å½’æ¨¡å‹" class="headerlink" title="åŸºäºæ¢¯åº¦ä¸‹é™æ³•çš„åŸºæœ¬å›å½’æ¨¡å‹"></a>åŸºäºæ¢¯åº¦ä¸‹é™æ³•çš„åŸºæœ¬å›å½’æ¨¡å‹</h2><pre class="line-numbers language-lang-python"><code class="language-lang-python">class BasicRegression(BaseEstimator):    def __init__(self, lr=0.001, penalty="None", C=0.01, tolerance=0.0001, max_iters=1000):        """åŸºäºæ¢¯åº¦ä¸‹é™æ³•çš„åŸºæœ¬å›å½’æ¨¡å‹        å‚æ•°        ----------        lr : å­¦ä¹ ç‡        penalty : æ­£åˆ™åŒ–é¡¹        C : æ­£åˆ™åŒ–ç³»æ•°        tolerance : æ¢¯åº¦ä¸‹é™æ›´æ–°åœæ­¢é˜ˆå€¼        max_iters : æœ€å¤§è¿­ä»£æ¬¡æ•°        """        self.C = C        self.penalty = penalty        self.tolerance = tolerance        self.lr = lr        self.max_iters = max_iters        self.errors = []        self.theta = []        self.n_samples, self.n_features = None, None        self.cost_func = None    def _loss(self, w):        raise NotImplementedError()    def init_cost(self):        raise NotImplementedError()    def _add_penalty(self, loss, w):        """Apply regularization to the loss."""        if self.penalty == "l1":            loss += self.C * np.abs(w[1:]).sum()        elif self.penalty == "l2":            loss += (0.5 * self.C) * (w[1:] ** 2).sum()        return loss    def _cost(self, X, y, theta):        prediction = X.dot(theta)        error = self.cost_func(y, prediction)        return error    def fit(self, X, y=None):        self._setup_input(X, y)        self.init_cost()        self.n_samples, self.n_features = X.shape        # Initialize weights + bias term        self.theta = np.random.normal(size=(self.n_features + 1), scale=0.5)        # Add an intercept column        self.X = self._add_intercept(self.X)        self._train()    @staticmethod    def _add_intercept(X):        b = np.ones([X.shape[0], 1])        return np.concatenate([b, X], axis=1)    def _train(self):        self.theta, self.errors = self._gradient_descent()        logging.info(" Theta: %s" % self.theta.flatten())    def _predict(self, X=None):        X = self._add_intercept(X)        return X.dot(self.theta)    def _gradient_descent(self):        theta = self.theta        errors = [self._cost(self.X, self.y, theta)]        # Get derivative of the loss function        cost_d = grad(self._loss)        for i in range(1, self.max_iters + 1):            # Calculate gradient and update theta            delta = cost_d(theta)            theta -= self.lr * delta            errors.append(self._cost(self.X, self.y, theta))            logging.info("Iteration %s, error %s" % (i, errors[i]))            error_diff = np.linalg.norm(errors[i - 1] - errors[i])            if error_diff < self.tolerance:                logging.info("Convergence has reached.")                break        return theta, errors<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="å®šä¹‰åŸºäºæ¢¯åº¦ä¸‹é™æ³•çš„çº¿æ€§å›å½’ä¸é€»è¾‘å›å½’æ¨¡å‹"><a href="#å®šä¹‰åŸºäºæ¢¯åº¦ä¸‹é™æ³•çš„çº¿æ€§å›å½’ä¸é€»è¾‘å›å½’æ¨¡å‹" class="headerlink" title="å®šä¹‰åŸºäºæ¢¯åº¦ä¸‹é™æ³•çš„çº¿æ€§å›å½’ä¸é€»è¾‘å›å½’æ¨¡å‹"></a>å®šä¹‰åŸºäºæ¢¯åº¦ä¸‹é™æ³•çš„çº¿æ€§å›å½’ä¸é€»è¾‘å›å½’æ¨¡å‹</h2><pre class="line-numbers language-lang-python"><code class="language-lang-python">class LinearRegression(BasicRegression):    """Linear regression with gradient descent optimizer."""    def _loss(self, w):        loss = self.cost_func(self.y, np.dot(self.X, w))        return self._add_penalty(loss, w)    def init_cost(self):        self.cost_func = mean_squared_errorclass LogisticRegression(BasicRegression):    """Binary logistic regression with gradient descent optimizer."""    def init_cost(self):        self.cost_func = binary_crossentropy    def _loss(self, w):        loss = self.cost_func(self.y, self.sigmoid(np.dot(self.X, w)))        return self._add_penalty(loss, w)    @staticmethod    def sigmoid(x):        return 0.5 * (np.tanh(0.5 * x) + 1)    def _predict(self, X=None):        X = self._add_intercept(X)        return self.sigmoid(X.dot(self.theta))<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="ç”¨ä¸€ä¸ªå°ä¾‹å­æ¥ä½¿ç”¨ä¸Šé¢å®ç°çš„çº¿æ€§å›å½’ä¸é€»è¾‘å›å½’æ¨¡å‹"><a href="#ç”¨ä¸€ä¸ªå°ä¾‹å­æ¥ä½¿ç”¨ä¸Šé¢å®ç°çš„çº¿æ€§å›å½’ä¸é€»è¾‘å›å½’æ¨¡å‹" class="headerlink" title="ç”¨ä¸€ä¸ªå°ä¾‹å­æ¥ä½¿ç”¨ä¸Šé¢å®ç°çš„çº¿æ€§å›å½’ä¸é€»è¾‘å›å½’æ¨¡å‹"></a>ç”¨ä¸€ä¸ªå°ä¾‹å­æ¥ä½¿ç”¨ä¸Šé¢å®ç°çš„çº¿æ€§å›å½’ä¸é€»è¾‘å›å½’æ¨¡å‹</h2><pre class="line-numbers language-lang-python"><code class="language-lang-python">import loggingtry:    from sklearn.model_selection import train_test_splitexcept ImportError:    from sklearn.cross_validation import train_test_splitfrom sklearn.datasets import make_classificationfrom sklearn.datasets import make_regression# Change to DEBUG to see convergencelogging.basicConfig(level=logging.ERROR)def regression():    # Generate a random regression problem    X, y = make_regression(        n_samples=10000, n_features=100, n_informative=75, n_targets=1, noise=0.05, random_state=1111, bias=0.5    )    X_train, X_test, y_train, y_test = train_test_split(X, y, test_size=0.25, random_state=1111)    model = LinearRegression(lr=0.01, max_iters=2000, penalty="l2", C=0.03)    model.fit(X_train, y_train)    predictions = model.predict(X_test)    print("regression mse", mean_squared_error(y_test, predictions))def classification():    # Generate a random binary classification problem.    X, y = make_classification(        n_samples=1000, n_features=100, n_informative=75, random_state=1111, n_classes=2, class_sep=2.5    )    X_train, X_test, y_train, y_test = train_test_split(X, y, test_size=0.1, random_state=1111)    model = LogisticRegression(lr=0.01, max_iters=500, penalty="l1", C=0.01)    model.fit(X_train, y_train)    predictions = model.predict(X_test)    print("classification accuracy", accuracy(y_test, predictions))<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><pre class="line-numbers language-lang-python"><code class="language-lang-python">regression()classification()<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><pre><code>regression mse 67.1561814262031classification accuracy 0.97</code></pre>]]></content>
      
      
      <categories>
          
          <category> æœºå™¨å­¦ä¹ æ¨¡å‹ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> é™é­” </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>çº¿æ€§æ¨¡å‹å…¬å¼æ¨å¯¼ï¼ˆä¸Šï¼‰</title>
      <link href="/2019/11/25/xian-xing-mo-xing-gong-shi-tui-dao-yi/"/>
      <url>/2019/11/25/xian-xing-mo-xing-gong-shi-tui-dao-yi/</url>
      
        <content type="html"><![CDATA[<h1 id="1çº¿æ€§æ¨¡å‹å…¬å¼æ¨å¯¼ï¼ˆä¸Šï¼‰"><a href="#1çº¿æ€§æ¨¡å‹å…¬å¼æ¨å¯¼ï¼ˆä¸Šï¼‰" class="headerlink" title="1çº¿æ€§æ¨¡å‹å…¬å¼æ¨å¯¼ï¼ˆä¸Šï¼‰"></a>1çº¿æ€§æ¨¡å‹å…¬å¼æ¨å¯¼ï¼ˆä¸Šï¼‰</h1><p>æœ¬ç¯‡å¯¹çº¿æ€§æ¨¡å‹ä¸­çš„ä¸€å…ƒçº¿æ€§å›å½’ä¸å¤šå…ƒçº¿æ€§å›å½’æ¨¡å‹è¿›è¡Œäº†æ¨å¯¼</p><h2 id="1-1ä¸€å…ƒçº¿æ€§å›å½’å…¬å¼æ¨å¯¼"><a href="#1-1ä¸€å…ƒçº¿æ€§å›å½’å…¬å¼æ¨å¯¼" class="headerlink" title="1.1ä¸€å…ƒçº¿æ€§å›å½’å…¬å¼æ¨å¯¼"></a>1.1ä¸€å…ƒçº¿æ€§å›å½’å…¬å¼æ¨å¯¼</h2><h3 id="1-1-1æ¨å¯¼æµç¨‹åŠæ€è·¯"><a href="#1-1-1æ¨å¯¼æµç¨‹åŠæ€è·¯" class="headerlink" title="1.1.1æ¨å¯¼æµç¨‹åŠæ€è·¯"></a>1.1.1æ¨å¯¼æµç¨‹åŠæ€è·¯</h3><ol><li><p>å…ˆç”±æœ€å°äºŒä¹˜æ³•å¯¼å‡ºæŸå¤±å‡½æ•°$E(w,b)$</p></li><li><p>è¯æ˜æŸå¤±å‡½æ•°$E(w,b)$æ˜¯å…³äºwå’Œbçš„å‡¸å‡½æ•°ã€‚ï¼ˆå› ä¸ºåªæœ‰å‡¸å‡½æ•°æ‰æœ‰æœ€å°å€¼ï¼‰</p></li><li><p>å¯¹æŸå¤±å‡½æ•°$E(w,b)$å…³äºw å’Œ båˆ†åˆ«æ±‚ä¸€é˜¶å¯¼æ•°</p></li><li><p>ä»¤ä¸€é˜¶åå¯¼æ•°ç­‰äº0è§£å‡ºwå’Œbã€‚</p></li></ol><h3 id="1-1-2æ ¸å¿ƒæ€æƒ³æ˜¯æœ€å°äºŒä¹˜æ³•"><a href="#1-1-2æ ¸å¿ƒæ€æƒ³æ˜¯æœ€å°äºŒä¹˜æ³•" class="headerlink" title="1.1.2æ ¸å¿ƒæ€æƒ³æ˜¯æœ€å°äºŒä¹˜æ³•"></a>1.1.2æ ¸å¿ƒæ€æƒ³æ˜¯æœ€å°äºŒä¹˜æ³•</h3><p>ä¸€å…ƒçº¿æ€§å›å½’å…¬å¼ï¼š$f(x_i)=wx_i+b$</p><h4 id="1-1-2-1ç”±æœ€å°äºŒä¹˜æ³•å¯¼å‡ºå¹³æ–¹æŸå¤±-E-w-b"><a href="#1-1-2-1ç”±æœ€å°äºŒä¹˜æ³•å¯¼å‡ºå¹³æ–¹æŸå¤±-E-w-b" class="headerlink" title="1.1.2.1ç”±æœ€å°äºŒä¹˜æ³•å¯¼å‡ºå¹³æ–¹æŸå¤± E(w,b)"></a>1.1.2.1ç”±æœ€å°äºŒä¹˜æ³•å¯¼å‡ºå¹³æ–¹æŸå¤± E(w,b)</h4><script type="math/tex; mode=display">\begin{aligned} E(w,b)    &= \sum _{i=1}^m(y_i-f(x_i))^2\\    &=\sum_{i=1}^m(y_i-(wx_i+b))^2\\    &=\sum_{i=1}^m(y_i-wx_i-b)^2 \qquad\qquad\qquad(1.1)\end{aligned}</script><h4 id="1-1-2-2æˆ‘ä»¬çš„ç›®çš„æ˜¯æ±‚å‡ºæŸå¤±å‡½æ•°E-w-b-å–æœ€å°å€¼æ—¶ï¼Œwä¸bçš„è§£"><a href="#1-1-2-2æˆ‘ä»¬çš„ç›®çš„æ˜¯æ±‚å‡ºæŸå¤±å‡½æ•°E-w-b-å–æœ€å°å€¼æ—¶ï¼Œwä¸bçš„è§£" class="headerlink" title="1.1.2.2æˆ‘ä»¬çš„ç›®çš„æ˜¯æ±‚å‡ºæŸå¤±å‡½æ•°E(w,b)å–æœ€å°å€¼æ—¶ï¼Œwä¸bçš„è§£"></a>1.1.2.2æˆ‘ä»¬çš„ç›®çš„æ˜¯æ±‚å‡ºæŸå¤±å‡½æ•°E(w,b)å–æœ€å°å€¼æ—¶ï¼Œwä¸bçš„è§£</h4><script type="math/tex; mode=display">(w^*,b^*)= \underset{(w,b)}{\operatorname{argmin}}\sum_{i=1}^m(y_i-wx_i-b)^2</script><h3 id="1-1-3åˆ¤æ–­æŸå¤±å‡½æ•°E-w-b-çš„å‡¹å‡¸æ€§"><a href="#1-1-3åˆ¤æ–­æŸå¤±å‡½æ•°E-w-b-çš„å‡¹å‡¸æ€§" class="headerlink" title="1.1.3åˆ¤æ–­æŸå¤±å‡½æ•°E(w,b)çš„å‡¹å‡¸æ€§"></a>1.1.3åˆ¤æ–­æŸå¤±å‡½æ•°E(w,b)çš„å‡¹å‡¸æ€§</h3><p>ç”±å‡¹å‡¸å‡½æ•°çš„åˆ¤å®šå®šç†ï¼šè®¾E(w,b)åœ¨åŒºåŸŸDä¸Šå…·æœ‰äºŒé˜¶è¿ç»­åå¯¼æ•°</p><p>è®°$A=Eâ€™â€™_{ww}(w,b),  B=Eâ€™â€™_{wb}(w,b), C=Eâ€™â€™_{bb}(w,b)$ åˆ™ï¼š$A&gt;0, ä¸” AC-B^2\geq0$ æ—¶ï¼ŒE(w,b)åœ¨åŒºåŸŸDä¸Šæ˜¯å‡¸å‡½æ•°ï¼›</p><h4 id="1-1-3-1æ ¹æ®ä¸Šè¿°å®šç†æˆ‘ä»¬å…ˆæ¥æ±‚Aï¼ŒAä¸ºE-w-b-å¯¹wçš„äºŒé˜¶åå¯¼æ•°-Eâ€™â€™-ww-w-b"><a href="#1-1-3-1æ ¹æ®ä¸Šè¿°å®šç†æˆ‘ä»¬å…ˆæ¥æ±‚Aï¼ŒAä¸ºE-w-b-å¯¹wçš„äºŒé˜¶åå¯¼æ•°-Eâ€™â€™-ww-w-b" class="headerlink" title="1.1.3.1æ ¹æ®ä¸Šè¿°å®šç†æˆ‘ä»¬å…ˆæ¥æ±‚Aï¼ŒAä¸ºE(w,b)å¯¹wçš„äºŒé˜¶åå¯¼æ•°$Eâ€™â€™_{ww}(w,b)$"></a>1.1.3.1æ ¹æ®ä¸Šè¿°å®šç†æˆ‘ä»¬å…ˆæ¥æ±‚Aï¼ŒAä¸ºE(w,b)å¯¹wçš„äºŒé˜¶åå¯¼æ•°$Eâ€™â€™_{ww}(w,b)$</h4><ol><li>æˆ‘ä»¬å…ˆæ±‚E(w,b)å¯¹wçš„ä¸€é˜¶åå¯¼æ•°ï¼š</li></ol><script type="math/tex; mode=display">\begin{aligned} E'_w(w,b)    &=\frac{\partial E(w,b)}{\partial w}\\    &=\frac{\partial }{\partial w}\bigg[\sum_{i=1}^m(y_i-wx_i-b)^2\bigg]\\    &=\sum_{i=1}^m\frac{\partial }{\partial w}(y_i-wx_i-b)^2\\    &=\sum_{i=1}^m2\cdot(y_i-wx_i-b)\cdot(-x_i)\\    &=2\bigg(w\sum_{i=1}^mx_i^2-\sum_{i=1}^m(y_i-b)x_i\bigg)\qquad\qquad\qquad(1.2)\end{aligned}</script><ol><li>ç„¶åæ ¹æ®ä¸Šè¿°ç»“æœè¿›è€Œæ±‚å‡ºA:</li></ol><script type="math/tex; mode=display">\begin{aligned}A    &=E''_{ww}(w,b)\\    &=\frac{\partial^2 E(w,b)}{\partial w^2}\\    &= \frac{\partial }{\partial w}\bigg(\frac{\partial E(w,b)}{\partial w}\bigg)\\    &= \frac{\partial }{\partial w}\bigg[2\bigg(w\sum_{i=1}^m x_i^2-\sum_{i=1}^m(y_i-b)x_i\bigg)\bigg]\\    &=\frac{\partial }{\partial w}\bigg[2w\sum_{i=1}^m x_i^2\bigg]\\    &=2\sum_{i=1}^mx_i^2 \qquad\qquad\qquad       è¿™å°±æ˜¯A=E''_{ww}(w,b)\end{aligned}</script><h4 id="1-1-3-2æ¥ä¸‹æ¥æˆ‘ä»¬æ¥æ±‚Bï¼ŒBä¸ºE-w-b-å¯¹wå’Œbçš„äºŒé˜¶æ··åˆåå¯¼æ•°-Eâ€™â€™-wb-w-b"><a href="#1-1-3-2æ¥ä¸‹æ¥æˆ‘ä»¬æ¥æ±‚Bï¼ŒBä¸ºE-w-b-å¯¹wå’Œbçš„äºŒé˜¶æ··åˆåå¯¼æ•°-Eâ€™â€™-wb-w-b" class="headerlink" title="1.1.3.2æ¥ä¸‹æ¥æˆ‘ä»¬æ¥æ±‚Bï¼ŒBä¸ºE(w,b)å¯¹wå’Œbçš„äºŒé˜¶æ··åˆåå¯¼æ•°: $Eâ€™â€™_{wb}(w,b)$"></a>1.1.3.2æ¥ä¸‹æ¥æˆ‘ä»¬æ¥æ±‚Bï¼ŒBä¸ºE(w,b)å¯¹wå’Œbçš„äºŒé˜¶æ··åˆåå¯¼æ•°: $Eâ€™â€™_{wb}(w,b)$</h4><script type="math/tex; mode=display">\begin{aligned} E''_{wb}(w,b)    &=\frac{\partial^2 E(w,b)}{\partial w \partial b}\\    &=\frac{\partial}{\partial b}\bigg(\frac{\partial E(w,b)}{\partial w}\bigg)\\    &=\frac{\partial}{\partial b}\bigg[2\bigg(w\sum_{i=1}^mx_i^2-\sum_{i=1}^m(y_i-b)x_i\bigg)\bigg]\\    &=\frac{\partial}{\partial b}\bigg[-2\sum_{i=1}^m(y_i-b)x_i\bigg]\\    &=\frac{\partial}{\partial b}\bigg(-2\sum_{i=1}^my_ix_i+2\sum_{i=1}^mbx_i\bigg)\\    &=2\sum_{i=1}^mx_i \qquad\qquad\qquad       è¿™å°±æ˜¯B=E''_{wb}(w,b)\end{aligned}</script><h4 id="1-1-3-3æœ€åæˆ‘ä»¬æ¥æ±‚Cï¼ŒCä¸ºE-w-b-å¯¹bçš„äºŒé˜¶åå¯¼æ•°-Eâ€™â€™-bb-w-b"><a href="#1-1-3-3æœ€åæˆ‘ä»¬æ¥æ±‚Cï¼ŒCä¸ºE-w-b-å¯¹bçš„äºŒé˜¶åå¯¼æ•°-Eâ€™â€™-bb-w-b" class="headerlink" title="1.1.3.3æœ€åæˆ‘ä»¬æ¥æ±‚Cï¼ŒCä¸ºE(w,b)å¯¹bçš„äºŒé˜¶åå¯¼æ•°$Eâ€™â€™_{bb}(w,b)$"></a>1.1.3.3æœ€åæˆ‘ä»¬æ¥æ±‚Cï¼ŒCä¸ºE(w,b)å¯¹bçš„äºŒé˜¶åå¯¼æ•°$Eâ€™â€™_{bb}(w,b)$</h4><ol><li>æˆ‘ä»¬å…ˆæ±‚E(w,b)å¯¹bçš„ä¸€é˜¶åå¯¼æ•°ï¼š$Eâ€™_b(w,b)=\frac{\partial E(w,b)}{\partial b}$</li></ol><script type="math/tex; mode=display">\begin{aligned} \frac{\partial E(w,b)}{\partial b}    &=\frac{\partial}{\partial b}\bigg[ \sum_{i=1}^m(y_i-wx_i-b)^2\bigg]\\    &=\sum_{i=1}^m\frac{\partial}{\partial b}(y_i-wx_i-b)^2\\    &=\sum_{i=1}^m2\cdot(y_i-wx_i-b)\cdot(-1)\\    &=2\bigg(mb-\sum_{i=1}^m(y_i-wx_i)\bigg)\qquad\qquad\qquad(1.3)\end{aligned}</script><ol><li>ç„¶åæ ¹æ®ä¸Šè¿°ç»“æœè¿›è€Œæ±‚å‡ºCã€‚ $C=Eâ€™â€™_{bb}(w,b)=\frac{\partial^2 E(w,b)}{\partial b^2}$</li></ol><script type="math/tex; mode=display">\begin{aligned} \frac{\partial^2 E(w,b)}{\partial b^2}    &=\frac{\partial}{\partial b}\bigg(\frac{\partial E(w,b)}{\partial b}\bigg)\\    &=\frac{\partial}{\partial b}\bigg[ 2\bigg(mb-\sum_{i=1}^m(y_i-wx_i)\bigg)\bigg]\\    &=2m\qquad\qquad\qquad       è¿™å°±æ˜¯C=E''_{bb}(w,b)\end{aligned}</script><h4 id="1-1-3-4ä¸‹é¢æˆ‘ä»¬æ ¹æ®ä¸Šé¢ç®—å‡ºçš„ABCçš„å€¼ï¼Œæ¥è¯æ˜E-w-b-çš„å‡¹å‡¸æ€§"><a href="#1-1-3-4ä¸‹é¢æˆ‘ä»¬æ ¹æ®ä¸Šé¢ç®—å‡ºçš„ABCçš„å€¼ï¼Œæ¥è¯æ˜E-w-b-çš„å‡¹å‡¸æ€§" class="headerlink" title="1.1.3.4ä¸‹é¢æˆ‘ä»¬æ ¹æ®ä¸Šé¢ç®—å‡ºçš„ABCçš„å€¼ï¼Œæ¥è¯æ˜E(w,b)çš„å‡¹å‡¸æ€§"></a>1.1.3.4ä¸‹é¢æˆ‘ä»¬æ ¹æ®ä¸Šé¢ç®—å‡ºçš„ABCçš„å€¼ï¼Œæ¥è¯æ˜E(w,b)çš„å‡¹å‡¸æ€§</h4><p>æˆ‘æŠŠå®šç†è´´è¿‡æ¥å†çœ‹ä¸€çœ¼ï¼šè®¾E(w,b)åœ¨åŒºåŸŸDä¸Šå…·æœ‰äºŒé˜¶è¿ç»­åå¯¼æ•°</p><p>è®°$A=Eâ€™â€™_{ww}(w,b),  B=Eâ€™â€™_{wb}(w,b), C=Eâ€™â€™_{bb}(w,b)$ åˆ™ï¼š$A&gt;0, ä¸” AC-B^2\geq0$ æ—¶ï¼ŒE(w,b)åœ¨åŒºåŸŸDä¸Šæ˜¯å‡¸å‡½æ•°ï¼›</p><p>ç”±ä¸Šæ–‡å¯å¾—ï¼š$A=2\sum\limits_{i=1}^mx_i^2\qquad\qquad B=2\sum\limits_{i=1}^mx_i\qquad\qquad C=2m$</p><p>Aæ˜¾ç„¶æ˜¯å¤§äº0çš„ã€‚</p><script type="math/tex; mode=display">\begin{aligned} AC-B^2    &=2m\cdot2\sum\limits_{i=1}^mx_i^2-\bigg( 2\sum\limits_{i=1}^mx_i\bigg)^2\\    &=4m\sum\limits_{i=1}^mx_i^2-4m\cdot\frac1m\cdot\bigg( \sum\limits_{i=1}^mx_i\bigg)^2\\    &=4m\sum\limits_{i=1}^mx_i^2-4m\cdot\bar x\cdot \sum\limits_{i=1}^mx_i\\    &=4m\bigg( \sum\limits_{i=1}^mx_i^2-\sum\limits_{i=1}^mx_i\bar x\bigg)\\    &=4m\sum\limits_{i=1}^m(x_i^2-x_i\bar x) \\    &=4m\sum\limits_{i=1}^m(x_i^2-x_i\bar x-x_i\bar x+x_i\bar x)\qquad\longleftarrow\qquadå› ä¸º\sum\limits_{i=1}^mx_i\bar x=m\bar x\bar x=\sum\limits_{i=1}^m\bar x^2\\    &=4m\sum\limits_{i=1}^m(x_i-\bar x)^2 \geq0\end{aligned}</script><p>ç”±ä¸Šå¯ä»¥è¯æ˜ï¼š$\color{red}{E(w,b)æ˜¯å…³äºwå’Œbçš„å‡¸å‡½æ•°.}$</p><h3 id="1-1-4ç®—å‡ºæŸå¤±å‡½æ•°å–æœ€å°å€¼æ—¶wä¸bçš„å€¼"><a href="#1-1-4ç®—å‡ºæŸå¤±å‡½æ•°å–æœ€å°å€¼æ—¶wä¸bçš„å€¼" class="headerlink" title="1.1.4ç®—å‡ºæŸå¤±å‡½æ•°å–æœ€å°å€¼æ—¶wä¸bçš„å€¼"></a>1.1.4ç®—å‡ºæŸå¤±å‡½æ•°å–æœ€å°å€¼æ—¶wä¸bçš„å€¼</h3><p>æ ¹æ®å®šç†ï¼šè®¾$E(w,b)$æ˜¯åœ¨Då†…æœ‰è¿ç»­åå¯¼æ•°çš„å‡¸å‡½æ•°</p><script type="math/tex; mode=display">(w^*ï¼Œb^*)\in D\quad ä¸”:E'_w(w{^*} , b {^*} )=0,E'_b(w^*,b^*)=0 \quadåˆ™:E(w^*,b^*)å¿…ä¸ºE(w,b)åœ¨Då†…çš„æœ€å°å€¼ã€‚</script><p>$å‰é¢çš„å°èŠ‚æˆ‘ä»¬è¯æ˜äº†æŸå¤±å‡½æ•°E(w,b)æ˜¯å‡¸å‡½æ•°ï¼Œæ‰€ä»¥E(w,b)å–æœ€å°å€¼æ—¶ï¼Œwä¸bçš„è§£æ»¡è¶³E(w,b)çš„ä¸€é˜¶åå¯¼æ•°ä¸º0$</p><h4 id="1-1-4-1å…ˆæ¥æ±‚b"><a href="#1-1-4-1å…ˆæ¥æ±‚b" class="headerlink" title="1.1.4.1å…ˆæ¥æ±‚b"></a>1.1.4.1å…ˆæ¥æ±‚b</h4><p>ä»¤ $\frac{\partial E(w,b)}{\partial b}=0$  (å³ï¼šå¼1.3=0)</p><script type="math/tex; mode=display">\frac{\partial E(w,b)}{\partial b}=2\bigg(mb-\sum_{i=1}^m(y_i-wx_i)\bigg)=0</script><script type="math/tex; mode=display">mb = \sum_{i=1}^m(y_i-wx_i)</script><script type="math/tex; mode=display">\begin{aligned}b^*    &=\frac1m\sum_{i=1}^m(y_i-wx_i)\\    &=\frac1m\sum_{i=1}^my_i-w\cdot\frac1m\sum_{i=1}^mx_i\\    &=\bar y-w\bar x\\\end{aligned}</script><h4 id="1-1-4-2å†æ¥æ±‚w"><a href="#1-1-4-2å†æ¥æ±‚w" class="headerlink" title="1.1.4.2å†æ¥æ±‚w"></a>1.1.4.2å†æ¥æ±‚w</h4><p>$ä»¤\frac{\partial E(w,b)}{\partial w}=0$  (å³ï¼šå¼1.2=0)</p><script type="math/tex; mode=display">\frac{\partial E(w,b)}{\partial w}=2\bigg(w\sum_{i=1}^mx_i^2-\sum_{i=1}^m(y_i-b)x_i\bigg)=0</script><script type="math/tex; mode=display">w\sum_{i=1}^mx_i^2=\sum_{i=1}^my_ix_i-\sum_{i=1}^mbx_i</script><script type="math/tex; mode=display">w\sum_{i=1}^mx_i^2=\sum_{i=1}^my_ix_i-\sum_{i=1}^m(\bar y-w\bar x)x_i</script><script type="math/tex; mode=display">w\sum_{i=1}^mx_i^2=\sum_{i=1}^my_ix_i-\bar y\sum_{i=1}^mx_i+w\bar x\sum_{i=1}^mx_i</script><script type="math/tex; mode=display">w\bigg(\sum_{i=1}^mx_i^2-\bar x\sum_{i=1}^mx_i\bigg)=\sum_{i=1}^my_ix_i-\bar y\sum_{i=1}^mx_i</script><script type="math/tex; mode=display">w^*=\frac{\sum\limits_{i=1}^my_ix_i-\bar y\sum\limits_{i=1}^mx_i}{\sum\limits_{i=1}^mx_i^2-\bar x\sum\limits_{i=1}^mx_i}\qquad\qquad(1.4)</script><p>å› ä¸ºï¼š</p><script type="math/tex; mode=display">\bar y\sum\limits_{i=1}^mx_i=\frac1m\sum\limits_{i=1}^my_i\sum\limits_{i=1}^mx_i=\bar x\sum\limits_{i=1}^my_i\qquad\qquad(1.5)</script><script type="math/tex; mode=display">\bar x\sum\limits_{i=1}^mx_i=\frac1m\sum\limits_{i=1}^mx_i\sum\limits_{i=1}^mx_i=\frac1m(\sum\limits_{i=1}^mx_i)^2\qquad\qquad(1.6)</script><p>å°†1.5å’Œ1.6ä»£å…¥1.4å¯å¾—ï¼š</p><script type="math/tex; mode=display">w^*=\frac{\sum\limits_{i=1}^my_ix_i-\bar x\sum\limits_{i=1}^my_i}{\sum\limits_{i=1}^mx_i^2-\frac1m(\sum\limits_{i=1}^mx_i)^2}=\frac{\sum\limits_{i=1}^my_i(x_i-\bar x)}{\sum\limits_{i=1}^mx_i^2-\frac1m(\sum\limits_{i=1}^mx_i)^2}</script><p>åˆ°æ­¤ä¸ºæ­¢æˆ‘ä»¬å°±æ±‚å‡ºäº†æŸå¤±å‡½æ•°å–æœ€å°å€¼æ—¶çš„wå’Œbçš„å€¼ã€‚</p><h2 id="1-2å¤šå…ƒçº¿æ€§å›å½’å…¬å¼æ¨å¯¼"><a href="#1-2å¤šå…ƒçº¿æ€§å›å½’å…¬å¼æ¨å¯¼" class="headerlink" title="1.2å¤šå…ƒçº¿æ€§å›å½’å…¬å¼æ¨å¯¼"></a>1.2å¤šå…ƒçº¿æ€§å›å½’å…¬å¼æ¨å¯¼</h2><h3 id="1-2-1å…ˆå¯¹å…¬å¼è¿›è¡Œä¸€ä¸ªç®€å•çš„å˜å½¢"><a href="#1-2-1å…ˆå¯¹å…¬å¼è¿›è¡Œä¸€ä¸ªç®€å•çš„å˜å½¢" class="headerlink" title="1.2.1å…ˆå¯¹å…¬å¼è¿›è¡Œä¸€ä¸ªç®€å•çš„å˜å½¢"></a>1.2.1å…ˆå¯¹å…¬å¼è¿›è¡Œä¸€ä¸ªç®€å•çš„å˜å½¢</h3><p>å¤šå…ƒçº¿æ€§å›å½’å…¬å¼ï¼šï¼ˆå¤§å®¶ä¸€å®šè¦è®°ä½ï¼šå¤šå…ƒçº¿æ€§å›å½’é‡Œå˜é‡ä¸ºå‘é‡ï¼‰</p><script type="math/tex; mode=display">\begin{aligned}f(x_i)&=w^Tx_i+b\\&=(w_1 \   w_2\  \cdots \   w_d)  \left(\begin{matrix}x_{i1}\\ x_{i2}  \\ \vdots \\ x_{id}\end{matrix}\right) +b\\&=w_1x_{i1}+w_2x_{i2}+\dots+w_dx_{id}+b\end{aligned}</script><p>ç°åœ¨æˆ‘ä»¬ä»¤ï¼š</p><p>$b=w_{d+1}  $</p><script type="math/tex; mode=display">\begin{aligned}f(x_i)&=(w_1 \   w_2\  \cdots \   w_d \   )  \left(\begin{matrix}x_{i1}\\ x_{i2}  \\ \vdots \\ x_{id}\end{matrix}\right) +b\\&=(w_1 \   w_2\  \cdots \   w_d \    w_{d+1})  \left(\begin{matrix}x_{i1}\\ x_{i2}  \\ \vdots \\ x_{id} \\ 1\end{matrix}\right)=\hat w \hat x_i\end{aligned}</script><p>é€šè¿‡ä¸Šé¢çš„æ–¹æ³•ï¼Œæˆ‘ä»¬æŠŠwå’Œbç»„åˆæˆäº†$\hat w$ åˆ™ï¼š</p><script type="math/tex; mode=display">f(\hat x_i)=\hat w^T\hat x_i</script><h3 id="1-2-2æ¨å¯¼æµç¨‹åŠæ€è·¯"><a href="#1-2-2æ¨å¯¼æµç¨‹åŠæ€è·¯" class="headerlink" title="1.2.2æ¨å¯¼æµç¨‹åŠæ€è·¯"></a>1.2.2æ¨å¯¼æµç¨‹åŠæ€è·¯</h3><ol><li>ç”±æœ€å°äºŒä¹˜æ³•å¯¼å‡ºæŸå¤±å‡½æ•°$E_{\hat w}$ã€‚</li></ol><ol><li>è¯æ˜æŸå¤±å‡½æ•°$E_{\hat w}æ˜¯å…³äº\hat w$çš„å‡¸å‡½æ•°ã€‚</li></ol><ol><li>å¯¹æŸå¤±å‡½æ•°$E_{\hat w}å…³äº\hat w$æ±‚ä¸€é˜¶å¯¼æ•°ã€‚</li></ol><ol><li>ä»¤ä¸€é˜¶å¯¼æ•°ç­‰äº0è§£å‡º$\hat w$</li></ol><h3 id="1-2-3æ ¸å¿ƒæ€æƒ³ä¾ç„¶æ˜¯æœ€å°äºŒä¹˜æ³•"><a href="#1-2-3æ ¸å¿ƒæ€æƒ³ä¾ç„¶æ˜¯æœ€å°äºŒä¹˜æ³•" class="headerlink" title="1.2.3æ ¸å¿ƒæ€æƒ³ä¾ç„¶æ˜¯æœ€å°äºŒä¹˜æ³•"></a>1.2.3æ ¸å¿ƒæ€æƒ³ä¾ç„¶æ˜¯æœ€å°äºŒä¹˜æ³•</h3><h4 id="1-2-3-1ç”±æœ€å°äºŒä¹˜æ³•å¯¼å‡ºæŸå¤±å‡½æ•°"><a href="#1-2-3-1ç”±æœ€å°äºŒä¹˜æ³•å¯¼å‡ºæŸå¤±å‡½æ•°" class="headerlink" title="1.2.3.1ç”±æœ€å°äºŒä¹˜æ³•å¯¼å‡ºæŸå¤±å‡½æ•°"></a>1.2.3.1ç”±æœ€å°äºŒä¹˜æ³•å¯¼å‡ºæŸå¤±å‡½æ•°</h4><p>æŸå¤±å‡½æ•°(å‡æ–¹è¯¯å·®)ä¸ºï¼š$E_{\hat{w}} = \sum\limits_{i=1}^m(y_i-f(\hat{x_i}))^2=\sum\limits_{i=1}^m(y_i-\hat{w} ^T  \hat{x_i})^2$</p><p>$X=\left(\begin{matrix}x_{11} &amp; x_{12} &amp;\cdots&amp;x_{1d}&amp;1\\ x_{12} &amp;x_{22} &amp;  \cdots&amp;  x_{2d}&amp;1 \\ \vdots &amp; \vdots  &amp;&amp;\vdots&amp;\vdots\\ x_{m1}&amp;x_{m2}&amp;\cdots&amp;x_{md}&amp;1\end{matrix}\right)= \left(\begin{matrix}x_1^T&amp;1\\ x_2^T&amp;1 \\ \vdots &amp;\vdots\\ x_m^T&amp;1\end{matrix}\right)=\left(\begin{matrix}\hat x_1^T\\ \hat x_2^T \\ \vdots \\ \hat x_m^T\end{matrix}\right)$</p><p>$Y=\left(\begin{matrix}y_1\\y_2 \\ \vdots \\y_m\end{matrix}\right)$</p><script type="math/tex; mode=display">\begin{aligned}E_{\hat{w}} &=\sum\limits_{i=1}^m\left(y_i-\hat w^T \hat x_i\right)^2\\&=\left( y_1-\hat w^T\hat x_1\right)^2+\left( y_2-\hat w^T\hat x_2\right)^2+\cdots+\left( y_m-\hat w^T\hat x_m\right)^2\\&=\left( y_1-\hat w^T\hat x_1 \quad  y_2-\hat w^T\hat x_2  \quad  \cdots \quad   y_m-\hat w^T\hat x_m\right)     \left(\begin{matrix} y_1-\hat w^T\hat x_1\\y_2-\hat w^T\hat x_2 \\ \vdots \\y_m-\hat w^T\hat x_m\end{matrix}\right)\\\end{aligned}</script><p>å› ä¸ºï¼š $\hat w^T\hat x_i = \hat x_i^T\hat wï¼ˆç­‰å¼ä¸¤è¾¹éƒ½æ˜¯æ ‡é‡ï¼‰  \qquad \qquad$  </p><p>æ‰€ä»¥ï¼š $\left(\begin{matrix} y_1-\hat w^T\hat x_1\\y_2-\hat w^T\hat x_2 \\ \vdots \\y_m-\hat w^T\hat x_m\end{matrix}\right)=\left(\begin{matrix}y_1\\y_2 \\ \vdots \\y_m\end{matrix}\right) - \left(\begin{matrix}\hat x_1^T\hat w\\\hat x_2^T\hat w\\ \vdots \\\hat x_m^T\hat w\end{matrix}\right)=\left(\begin{matrix}y_1\\y_2 \\ \vdots \\y_m\end{matrix}\right)-\left(\begin{matrix}\hat x_1^T\\\hat x_2^T\\ \vdots \\\hat x_m^T\end{matrix}\right)\cdot\hat w=Y-X\cdot\hat w$$</p><p>æ‰€ä»¥   $E_{\hat w} = \left( y_1-\hat w^T\hat x_1 \quad  y_2-\hat w^T\hat x_2  \quad  \cdots \quad   y_m-\hat w^T\hat x_m\right)     \left(\begin{matrix} y_1-\hat w^T\hat x_1\\y_2-\hat w^T\hat x_2 \\ \vdots \\y_m-\hat w^T\hat x_m\end{matrix}\right)= \left(Y-X\hat w\right)^T\left(Y-X\hat w\right)\qquad\qquad(1.7)$</p><h3 id="1-2-4åˆ¤æ–­æŸå¤±å‡½æ•°Eçš„å‡¹å‡¸æ€§"><a href="#1-2-4åˆ¤æ–­æŸå¤±å‡½æ•°Eçš„å‡¹å‡¸æ€§" class="headerlink" title="1.2.4åˆ¤æ–­æŸå¤±å‡½æ•°Eçš„å‡¹å‡¸æ€§"></a>1.2.4åˆ¤æ–­æŸå¤±å‡½æ•°Eçš„å‡¹å‡¸æ€§</h3><p>å¦‚æœ$E_{\hat w} $çš„HessiançŸ©é˜µæ˜¯æ­£å®šçš„ï¼Œåˆ™$E_{\hat w} $å³æ˜¯å‡¸å‡½æ•°ã€‚</p><script type="math/tex; mode=display">\begin{aligned}\frac{\partial E_{\hat w} }{\partial \hat w}&=\frac{\partial}{\partial \hat w}\left[\left(Y-X\hat w\right)^T\left(Y-X\hat w\right)\right]\\&=\frac{\partial}{\partial \hat w}\left[\left(Y^T-\hat w^T X^T\right)^T\left(Y-X\hat w\right)\right]\\&=\frac{\partial}{\partial \hat w}\left[\left(Y^T-\hat w^T X^T\right)^T\left(Y-X\hat w\right)\right]\\&=\frac{\partial}{\partial \hat w}\left[Y^TY-Y^TX\hat w-\hat w^TX^TY+\hat w^TX^TX\hat w\right]\\&=\frac{\partial Y^TX\hat w}{\partial \hat w}-\frac{\partial \hat w^TX^TY}{\partial \hat w}+\frac{\partial \hat w^TX^TX\hat w}{\partial \hat w}\end{aligned}</script><p>å› ä¸ºï¼š $\frac{\partial x^Ta }{\partial x}=\frac{\partial a^Tx }{\partial x}=a\qquad\frac{\partial x^Tbx }{\partial x}=(b+b^T)x\qquad\qquad$</p><p>æ‰€ä»¥ï¼š$\frac{\partial E_{\hat w} }{\partial \hat w}=-X^TY-X^TY+(X^TX+X^TX)\hat w=2X^T(X\hat w-Y)\qquad\qquad(1.8)$</p><p>æ¥ä¸‹æ¥æ±‚2é˜¶åå¯¼æ•°ï¼š</p><script type="math/tex; mode=display">\begin{aligned}\frac{\partial^2 E_{\hat w} }{\partial \hat w\partial \hat w^T}&=\frac{\partial}{\partial \hat w}\left(\frac{\partial E_{\hat w} }{\partial \hat w}\right)\\&=\frac{\partial}{\partial \hat w}\left[2X^T(X\hat w-Y)\right]\\&=\frac{\partial}{\partial \hat w}\left(2X^TX\hat w-2X^TY\right)\\&=2X^TX\qquad\qquad (HessiançŸ©é˜µ)\end{aligned}</script><h3 id="1-2-5æ±‚è§£æŸå¤±å‡½æ•°æœ€å°æ—¶çš„å‚æ•°çš„è§£"><a href="#1-2-5æ±‚è§£æŸå¤±å‡½æ•°æœ€å°æ—¶çš„å‚æ•°çš„è§£" class="headerlink" title="1.2.5æ±‚è§£æŸå¤±å‡½æ•°æœ€å°æ—¶çš„å‚æ•°çš„è§£"></a>1.2.5æ±‚è§£æŸå¤±å‡½æ•°æœ€å°æ—¶çš„å‚æ•°çš„è§£</h3><p>ä»¤ï¼ˆ1.8ï¼‰  $\frac{\partial E_{\hat w} }{\partial \hat w}=2X^T(X\hat w-Y)=0  \qquadå¾—å‡º\qquad2X^TX \hat w=2X^TY$</p><p>ç­‰å¼ä¸¤è¾¹éƒ½ä¹˜ä»¥$(X^TX)^{-1}\qquad  å¾— \hat w = (X^TX)^{-1}X^TY\qquad\qquad(1.9)$</p><p>è‡³æ­¤æˆ‘ä»¬å°±æ±‚å‡ºäº†æŸå¤±å‡½æ•°å–æœ€å°å€¼æ—¶$\hat w$çš„å€¼</p><h2 id="1-3ç»“æŸ"><a href="#1-3ç»“æŸ" class="headerlink" title="1.3ç»“æŸ"></a>1.3ç»“æŸ</h2><p>å‰é¢1.1å’Œ1.2ä¸¤ä¸ªç« èŠ‚åˆ†åˆ«å¯¹ä¸€å…ƒçº¿æ€§å›å½’å’Œå¤šå…ƒçº¿æ€§å›å½’çš„æ¨¡å‹çš„å…¬å¼è¿›è¡Œäº†æ¨å¯¼ï¼Œä¸‹ä¸€ç¯‡å°†å¯¹é€»è¾‘å›å½’å’Œæ„ŸçŸ¥æœºæ¨¡å‹è¿›è¡Œæ¨å¯¼ã€‚</p>]]></content>
      
      
      <categories>
          
          <category> æœºå™¨å­¦ä¹ æ¨¡å‹ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> é™é­” </tag>
            
        </tags>
      
    </entry>
    
    
  
  
</search>
